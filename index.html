.btn-admin {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);
            color: white;
        }

        .btn-admin:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(156, 39, 176, 0.3);
        }<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎèÖÏÑúÏã§ ÌôîÏû•Ïã§ Ïô∏Ï∂ú Í¥ÄÎ¶¨</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöª</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .input-section {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e1e8ff;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .input-field {
            flex: 1;
            min-width: 150px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dde4ff;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        input[readonly] {
            background: #f0f0f0 !important;
            color: #666 !important;
            cursor: not-allowed;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .btn-demo {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
        }

        .btn-demo:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(23, 162, 184, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .active-list {
            background: white;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e1e8ff;
            overflow: hidden;
        }

        .list-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            font-weight: 600;
            font-size: 18px;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            transition: all 0.3s ease;
        }

        .list-item:hover {
            background: #f8f9ff;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .user-name {
            font-weight: 600;
            font-size: 16px;
            color: #333;
        }

        .user-number {
            color: #666;
            font-size: 14px;
        }

        .timer-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .timer {
            font-weight: 700;
            font-size: 20px;
            color: #4facfe;
        }

        .timer.warning {
            color: #ff6b00;
        }

        .timer.danger {
            color: #f44336;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status.normal {
            background: #e8f5e8;
            color: #4caf50;
        }

        .status.warning {
            background: #fff3cd;
            color: #ff6b00;
        }

        .status.danger {
            background: #ffeaea;
            color: #f44336;
        }

        .return-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .return-btn:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #e1e8ff;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #4facfe;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }

        .notification.warning {
            background: #ff6b6b;
        }

        .notification.info {
            background: #17a2b8;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .footer {
            text-align: center;
            padding: 20px;
            background: #f8f9ff;
            color: #666;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }

            .button-group {
                flex-direction: column;
            }

            .list-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .timer-info {
                align-items: flex-start;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                width: 95%;
                margin: 10px;
            }
        }

        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .records-summary {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }

        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .summary-label {
            font-size: 14px;
            color: #666;
        }

        .summary-value {
            font-size: 18px;
            font-weight: 700;
            color: #4facfe;
        }

        .records-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 8px;
            background: white;
            transition: all 0.3s ease;
        }

        .record-item:hover {
            background: #f8f9ff;
            border-color: #4facfe;
        }

        .record-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .record-name {
            font-weight: 600;
            color: #333;
        }

        .record-number {
            font-size: 12px;
            color: #666;
        }

        .record-times {
            display: flex;
            flex-direction: column;
            gap: 3px;
            text-align: right;
        }

        .record-duration {
            font-size: 12px;
            color: #666;
        }

        .record-time {
            font-size: 12px;
            color: #888;
        }

        .duration-normal {
            color: #4caf50;
        }

        .duration-warning {
            color: #ff6b00;
        }

        .duration-danger {
            color: #f44336;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöª ÎèÖÏÑúÏã§ ÌôîÏû•Ïã§ Ïô∏Ï∂ú Í¥ÄÎ¶¨</h1>
            <p>Ìö®Ïú®Ï†ÅÏù∏ ÌôîÏû•Ïã§ Ïù¥Ïö© ÏãúÍ∞Ñ Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú (Ï†úÌïúÏãúÍ∞Ñ: 10Î∂Ñ)</p>
        </div>

        <div class="main-content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalOut">0</div>
                    <div class="stat-label">ÌòÑÏû¨ Ïô∏Ï∂ú Ï§ë</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalWarning">0</div>
                    <div class="stat-label">ÏãúÍ∞Ñ Ï¥àÍ≥º</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayTotal">0</div>
                    <div class="stat-label">Ïò§Îäò Ï¥ù Ïô∏Ï∂ú</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="dailyRecords">0</div>
                    <div class="stat-label">Ïò§Îäò Ï∂úÏûÖ Í∏∞Î°ù</div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-group">
                    <div class="input-field">
                        <label for="studentNumber">ÌïôÏÉù Î≤àÌò∏</label>
                        <input type="text" id="studentNumber" placeholder="Ï¢åÏÑù Î≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" autocomplete="off">
                    </div>
                    <div class="input-field">
                        <label for="studentName">Ïù¥Î¶Ñ</label>
                        <input type="text" id="studentName" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" autocomplete="off">
                    </div>
                    <div class="input-field">
                        <label for="timeLimit">Ï†úÌïú ÏãúÍ∞Ñ</label>
                        <input type="text" value="10Î∂Ñ (Í≥†Ï†ï)" readonly>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="startRestroom()">
                        üöª ÌôîÏû•Ïã§ Ïô∏Ï∂ú
                    </button>
                    <button class="btn btn-demo" onclick="addDemoData()">
                        üé¨ Îç∞Î™® Î≥¥Í∏∞
                    </button>
                    <button class="btn btn-admin" onclick="showDailyRecords()">
                        üìä Ï∂úÏûÖ Í∏∞Î°ù
                    </button>
                    <button class="btn btn-danger" onclick="clearAll()">
                        üîÑ Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî
                    </button>
                </div>
            </div>

            <div class="active-list">
                <div class="list-header">
                    üìã ÌòÑÏû¨ Ïô∏Ï∂ú Ï§ëÏù∏ ÌïôÏÉù Î™©Î°ù
                </div>
                <div id="activeList">
                    <div class="empty-state">
                        ÌòÑÏû¨ Ïô∏Ï∂ú Ï§ëÏù∏ ÌïôÏÉùÏù¥ ÏóÜÏäµÎãàÎã§.
                    </div>
                </div>
            </div>

            <!-- Ï∂úÏûÖ Í∏∞Î°ù Î™®Îã¨ -->
            <div class="modal" id="recordsModal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>üìä Ïò§ÎäòÏùò Ï∂úÏûÖ Í∏∞Î°ù</h2>
                        <button class="modal-close" onclick="closeRecordsModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="records-summary">
                            <div class="summary-item">
                                <span class="summary-label">Ï¥ù Ï∂úÏûÖ ÌöüÏàò:</span>
                                <span class="summary-value" id="totalRecordsCount">0</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Ïò§Îäò ÎÇ†Ïßú:</span>
                                <span class="summary-value" id="currentDateDisplay"></span>
                            </div>
                        </div>
                        <div class="records-list" id="recordsList">
                            <!-- Í∏∞Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-demo" onclick="exportRecords()">üì• Í∏∞Î°ù ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                        <button class="btn btn-danger" onclick="clearDailyRecords()">üóëÔ∏è Í∏∞Î°ù ÏÇ≠Ï†ú</button>
                        <button class="btn btn-primary" onclick="closeRecordsModal()">Îã´Í∏∞</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            ¬© 2025 ÎèÖÏÑúÏã§ ÌôîÏû•Ïã§ Ïô∏Ï∂ú Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú | 
            GitHub PagesÎ°ú Ìò∏Ïä§ÌåÖ | 
            Î¨∏Ïùò: Í∞úÎ∞úÏûêÏóêÍ≤å Ïó∞ÎùΩ
        </div>
    </div>

    <script>
        // ÎèÖÏÑúÏã§ Ï¢åÏÑù Ï†ïÎ≥¥
        const seatData = {
            41: "Ï°∞ÎØºÏßÄ", 34: "Ï†ïÏòàÎπà", 27: "ÍπÄÌòÑÎÇò", 20: "Ïù¥ÏÑúÏó∞2", 14: "ÍπÄÏú†ÏßÑ2", 8: "ÏßÑÏÑ∏Ìù¨", 1: "Ïã†ÏßÄÏú§",
            42: "ÌïúÏòàÎ¶∞", 35: "ÍπÄÏïÑÎ¶Ñ", 28: "Î¨∏ÏßÄÌòÑ", 21: "ÍπÄÎØºÏÑ±3", 15: "ÍπÄÎèÑÏú§2", 9: "ÍπÄÏÑúÏòÅ", 2: "ÍπÄÏ§ÄÏÑ±",
            43: "Î∞ïÏ£ºÏó∞", 36: "Ïù¥Ïû¨Ïõê", 29: "ÌïúÏû¨Ïõê", 22: "ÍπÄÏÑúÏú§3", 16: "Íµ¨ÏõêÎ™®", 10: "ÌåÄÎ™ÖÏÑú2", 3: "Ïù¥Ïú†ÏßÑ2",
            44: "Î∞∞Ï§ÄÌò∏", 37: "ÏÑ±Ïó∞Ï£º", 30: "Ï†ïÏãúÌòÑ", 23: "Ïù¥ÏÉÅÌòÑ2", 17: "ÍπÄÌÉúÏÑ†", 11: "Ïû•Ïú†ÏßÑ2", 4: "Ìô©ÏäπÌïò",
            45: "Ï†ïÏùÄÏú†", 38: "Ïò§ÏãúÌòÑ", 31: "Ïù¥ÏòàÏõê", 24: "Ï†ïÎØºÏÑ±", 18: "ÏûÑÏòàÏ§Ä2", 12: "Ïù¥ÏÑúÏùÄ3", 5: "ÍπÄÎã§Ï†ï",
            46: "ÏµúÎèôÎπà2", 39: "Î∞ïÏÑúÏòÅ", 32: "Î∞ïÏäπÏ±Ñ", 25: "Ï†ÑÏ§ÄÌòÅ", 19: "Ï†ïÎØºÏ§Ä", 13: "Î∞±ÏßÄÏú§", 6: "ÍπÄÎÇòÍ≤Ω",
            47: "", 40: "ÍπÄÏàòÎØº3", 33: "Î∞ïÏãúÌòÑ2", 26: "ÍπÄÍ±¥Ïö∞", 7: "ÏµúÎØºÏÑú"
        };

        let activeUsers = [];
        let timers = {};
        let todayCount = 0;
        let dailyRecords = []; // ÌïòÎ£® Ï∂úÏûÖ Í∏∞Î°ù
        let currentDate = new Date().toDateString();

        function updateStats() {
            document.getElementById('totalOut').textContent = activeUsers.length;
            document.getElementById('totalWarning').textContent = activeUsers.filter(user => user.isOvertime).length;
            document.getElementById('todayTotal').textContent = todayCount;
            document.getElementById('dailyRecords').textContent = dailyRecords.length;
        }

        function showNotification(message, type = 'success') {
            // Í∏∞Ï°¥ ÏïåÎ¶º Ï†úÍ±∞
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(n => n.remove());

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function getTimerStatus(remainingTime) {
            if (remainingTime > 300) return 'normal'; // 5Î∂Ñ Ïù¥ÏÉÅ
            if (remainingTime > 0) return 'warning'; // 5Î∂Ñ Ïù¥Ìïò
            return 'danger'; // ÏãúÍ∞Ñ Ï¥àÍ≥º
        }

        function startRestroom() {
            const number = document.getElementById('studentNumber').value.trim();
            const name = document.getElementById('studentName').value.trim();
            const timeLimit = 10; // 10Î∂Ñ Í≥†Ï†ï

            if (!number) {
                showNotification('ÌïôÏÉù Î≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning');
                document.getElementById('studentNumber').focus();
                return;
            }

            // Ï¢åÏÑùÌëúÏóêÏÑú Ïù¥Î¶Ñ ÏûêÎèô ÏôÑÏÑ±
            let finalName = name;
            if (seatData[number] && seatData[number] !== "") {
                finalName = seatData[number];
            } else if (!name) {
                showNotification('Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning');
                document.getElementById('studentName').focus();
                return;
            }

            // Ïù¥ÎØ∏ Ïô∏Ï∂ú Ï§ëÏù∏ÏßÄ ÌôïÏù∏
            if (activeUsers.find(user => user.number === number)) {
                showNotification(`${finalName}ÎãòÏùÄ Ïù¥ÎØ∏ Ïô∏Ï∂ú Ï§ëÏûÖÎãàÎã§.`, 'warning');
                return;
            }

            const user = {
                number: number,
                name: finalName,
                startTime: Date.now(),
                timeLimit: timeLimit * 60, // Ï¥à Îã®ÏúÑÎ°ú Î≥ÄÌôò (10Î∂Ñ = 600Ï¥à)
                isOvertime: false
            };

            activeUsers.push(user);
            todayCount++;
            
            startTimer(user);
            updateActiveList();
            updateStats();
            
            showNotification(`${finalName}ÎãòÏù¥ ÌôîÏû•Ïã§Î°ú Ïô∏Ï∂úÌñàÏäµÎãàÎã§. (Ï†úÌïúÏãúÍ∞Ñ: 10Î∂Ñ)`, 'info');
            
            // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
            document.getElementById('studentNumber').value = '';
            document.getElementById('studentName').value = '';
            document.getElementById('studentNumber').focus();
        }

        function startTimer(user) {
            const timerId = setInterval(() => {
                const elapsed = Math.floor((Date.now() - user.startTime) / 1000);
                const remaining = user.timeLimit - elapsed;
                
                if (remaining <= 0 && !user.isOvertime) {
                    user.isOvertime = true;
                    showNotification(`‚ö†Ô∏è ${user.name}ÎãòÏùò Ïô∏Ï∂ú ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§!`, 'warning');
                    
                    // ÏÜåÎ¶¨ ÏïåÎ¶º (Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏßÄÏõêÌïòÎäî Í≤ΩÏö∞)
                    try {
                        if ('speechSynthesis' in window) {
                            const utterance = new SpeechSynthesisUtterance(`${user.name}ÎãòÏùò Ïô∏Ï∂ú ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§`);
                            utterance.lang = 'ko-KR';
                            utterance.rate = 0.8;
                            speechSynthesis.speak(utterance);
                        }
                    } catch (e) {
                        console.log('ÏùåÏÑ± ÏïåÎ¶º ÏßÄÏõêÎêòÏßÄ ÏïäÏùå');
                    }
                }
                
                updateActiveList();
                updateStats();
            }, 1000);
            
            timers[user.number] = timerId;
        }

        function returnUser(number) {
            const userIndex = activeUsers.findIndex(user => user.number === number);
            if (userIndex !== -1) {
                const user = activeUsers[userIndex];
                const endTime = Date.now();
                const duration = Math.floor((endTime - user.startTime) / 1000);
                
                // Ï∂úÏûÖ Í∏∞Î°ùÏóê Ï∂îÍ∞Ä
                addToRecords(user, duration, endTime);
                
                clearInterval(timers[number]);
                delete timers[number];
                activeUsers.splice(userIndex, 1);
                
                updateActiveList();
                updateStats();
                showNotification(`${user.name}ÎãòÏù¥ Î≥µÍ∑ÄÌñàÏäµÎãàÎã§.`);
            }
        }

        function updateActiveList() {
            const listContainer = document.getElementById('activeList');
            
            if (activeUsers.length === 0) {
                listContainer.innerHTML = '<div class="empty-state">ÌòÑÏû¨ Ïô∏Ï∂ú Ï§ëÏù∏ ÌïôÏÉùÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            listContainer.innerHTML = activeUsers.map(user => {
                const elapsed = Math.floor((Date.now() - user.startTime) / 1000);
                const remaining = user.timeLimit - elapsed;
                const status = getTimerStatus(remaining);
                const timeDisplay = remaining > 0 ? formatTime(remaining) : formatTime(Math.abs(remaining));
                const statusText = remaining > 0 ? 'ÎÇ®ÏùÄ ÏãúÍ∞Ñ' : 'Ï¥àÍ≥º ÏãúÍ∞Ñ';
                
                return `
                    <div class="list-item">
                        <div class="user-info">
                            <div class="user-name">${user.name}</div>
                            <div class="user-number">Ï¢åÏÑù Î≤àÌò∏: ${user.number}</div>
                        </div>
                        <div class="timer-info">
                            <div class="timer ${status}">${timeDisplay}</div>
                            <div class="status ${status}">${statusText}</div>
                        </div>
                        <button class="return-btn" onclick="returnUser('${user.number}')">
                            Î≥µÍ∑Ä ÏôÑÎ£å
                        </button>
                    </div>
                `;
            }).join('');
        }

        function clearAll() {
            if (activeUsers.length === 0) {
                showNotification('Ï¥àÍ∏∞ÌôîÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.', 'warning');
                return;
            }
            
            if (confirm('Î™®Îì† Ïô∏Ï∂ú Í∏∞Î°ùÏùÑ Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                Object.values(timers).forEach(timer => clearInterval(timer));
                timers = {};
                activeUsers = [];
                todayCount = 0;
                updateActiveList();
                updateStats();
                showNotification('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
            }
        }

        // Îç∞Î™® Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä Ìï®Ïàò
        function addDemoData() {
            if (activeUsers.length > 0) {
                if (!confirm('ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏäµÎãàÎã§. Îç∞Î™®Î•º Ï∂îÍ∞ÄÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    return;
                }
            }

            // Îç∞Î™®Ïö© ÏÇ¨Ïö©ÏûêÎì§ Ï∂îÍ∞Ä (Î™®Îëê 10Î∂Ñ Ï†úÌïú)
            const demoUsers = [
                { number: "27", name: "ÍπÄÌòÑÎÇò", timeLimit: 10 * 60, elapsed: 6 * 60 }, // 6Î∂Ñ Í≤ΩÍ≥º
                { number: "42", name: "ÌïúÏòàÎ¶∞", timeLimit: 10 * 60, elapsed: 12 * 60 }, // 2Î∂Ñ Ï¥àÍ≥º
                { number: "15", name: "ÍπÄÎèÑÏú§2", timeLimit: 10 * 60, elapsed: 3 * 60 }, // 3Î∂Ñ Í≤ΩÍ≥º
            ];

            demoUsers.forEach(demo => {
                // Ï§ëÎ≥µ Ï≤¥ÌÅ¨
                if (!activeUsers.find(user => user.number === demo.number)) {
                    const user = {
                        number: demo.number,
                        name: demo.name,
                        startTime: Date.now() - (demo.elapsed * 1000),
                        timeLimit: demo.timeLimit,
                        isOvertime: demo.elapsed > demo.timeLimit
                    };
                    
                    activeUsers.push(user);
                    startTimer(user);
                }
            });

            if (todayCount < 10) {
                todayCount = 12; // Ïò§Îäò Ï¥ù Ïô∏Ï∂ú ÌöüÏàò
            }
            
            updateActiveList();
            updateStats();
            
            showNotification('Îç∞Î™® Îç∞Ïù¥ÌÑ∞Í∞Ä Î°úÎìúÎêòÏóàÏäµÎãàÎã§! Ïã§ÏãúÍ∞ÑÏúºÎ°ú ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî.', 'info');
        }

        // Ï¢åÏÑù Î≤àÌò∏ ÏûÖÎ†• Ïãú ÏûêÎèô Ïù¥Î¶Ñ ÏôÑÏÑ±
        document.getElementById('studentNumber').addEventListener('input', function(e) {
            const number = e.target.value.trim();
            const nameField = document.getElementById('studentName');
            
            if (seatData[number] && seatData[number] !== "") {
                nameField.value = seatData[number];
                nameField.style.backgroundColor = '#e8f5e8';
                nameField.style.borderColor = '#4caf50';
            } else {
                if (nameField.value === seatData[e.target.dataset.lastNumber]) {
                    nameField.value = '';
                }
                nameField.style.backgroundColor = '';
                nameField.style.borderColor = '#dde4ff';
            }
            
            e.target.dataset.lastNumber = number;
        });

        // ÏóîÌÑ∞ÌÇ§Î°ú Ïô∏Ï∂ú ÏãúÏûë
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startRestroom();
            }
        });

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            loadDailyRecords(); // Ïò§ÎäòÏùò Ï∂úÏûÖ Í∏∞Î°ù Î∂àÎü¨Ïò§Í∏∞
            checkDayReset(); // ÎÇ†Ïßú Î≥ÄÍ≤Ω Ï≤¥ÌÅ¨
            updateStats();
            updateActiveList();
            document.getElementById('studentNumber').focus();
            
            // ÏõπÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å ÏïåÎ¶º
            setTimeout(() => {
                showNotification('ÎèÖÏÑúÏã§ ÌôîÏû•Ïã§ Ïô∏Ï∂ú Í¥ÄÎ¶¨ ÏãúÏä§ÌÖúÏù¥ Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§!', 'info');
            }, 1000);
            
            // 3Ï¥à ÌõÑ Îç∞Î™® Îç∞Ïù¥ÌÑ∞ ÏûêÎèô Ï∂îÍ∞Ä (Í∞úÎ∞úÏö©)
            setTimeout(() => {
                if (confirm('Îç∞Î™® Îç∞Ïù¥ÌÑ∞Î•º ÏûêÎèôÏúºÎ°ú Î°úÎìúÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    addDemoData();
                }
            }, 3000);
        });

        // Ï∂úÏûÖ Í∏∞Î°ù Í¥ÄÎ†® Ìï®ÏàòÎì§
        function addToRecords(user, duration, endTime) {
            checkDayReset(); // ÎÇ†Ïßú Î≥ÄÍ≤Ω Ï≤¥ÌÅ¨
            
            const record = {
                number: user.number,
                name: user.name,
                startTime: user.startTime,
                endTime: endTime,
                duration: duration,
                isOvertime: duration > 600, // 10Î∂Ñ Ï¥àÍ≥º Ïó¨Î∂Ä
                date: new Date().toDateString()
            };
            
            dailyRecords.push(record);
            saveDailyRecords();
        }

        function loadDailyRecords() {
            const today = new Date().toDateString();
            const stored = localStorage.getItem(`dailyRecords_${today}`);
            
            if (stored) {
                try {
                    const data = JSON.parse(stored);
                    // Ïò§Ï†Ñ 8Ïãú Ïù¥ÌõÑ Í∏∞Î°ùÎßå Î°úÎìú
                    const now = new Date();
                    const startTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 8, 0, 0);
                    
                    dailyRecords = data.filter(record => new Date(record.endTime) >= startTime);
                    todayCount = dailyRecords.length;
                } catch (e) {
                    console.log('Ï∂úÏûÖ Í∏∞Î°ù Î°úÎìú Ïã§Ìå®');
                    dailyRecords = [];
                }
            }
        }

        function saveDailyRecords() {
            const today = new Date().toDateString();
            localStorage.setItem(`dailyRecords_${today}`, JSON.stringify(dailyRecords));
        }

        function checkDayReset() {
            const today = new Date().toDateString();
            const now = new Date();
            
            // ÏûêÏ†ïÏù¥ ÏßÄÎÇ¨Í±∞ÎÇò ÎÇ†ÏßúÍ∞Ä Î∞îÎÄåÏóàÏùÑ Îïå
            if (currentDate !== today) {
                // ÏûêÏ†ï(00:00)Ïóê Ï†ÑÎÇ† Í∏∞Î°ù Ï†ïÎ¶¨
                if (now.getHours() === 0 && now.getMinutes() < 5) {
                    clearOldRecords();
                }
                
                currentDate = today;
                dailyRecords = [];
                todayCount = 0;
                
                // Ïò§Ï†Ñ 8Ïãú Ïù¥ÌõÑÎùºÎ©¥ Ïò§Îäò Í∏∞Î°ù Î°úÎìú
                if (now.getHours() >= 8) {
                    loadDailyRecords();
                }
                
                updateStats();
            }
        }

        function clearOldRecords() {
            // 3Ïùº Ïù¥Ï†Ñ Í∏∞Î°ù ÏÇ≠Ï†ú
            const threeDaysAgo = new Date();
            threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
            
            const keys = Object.keys(localStorage);
            keys.forEach(key => {
                if (key.startsWith('dailyRecords_')) {
                    const dateStr = key.replace('dailyRecords_', '');
                    const recordDate = new Date(dateStr);
                    
                    if (recordDate < threeDaysAgo) {
                        localStorage.removeItem(key);
                    }
                }
            });
        }

        function showDailyRecords() {
            const modal = document.getElementById('recordsModal');
            const recordsList = document.getElementById('recordsList');
            const totalCount = document.getElementById('totalRecordsCount');
            const dateDisplay = document.getElementById('currentDateDisplay');
            
            modal.style.display = 'flex';
            totalCount.textContent = dailyRecords.length;
            dateDisplay.textContent = new Date().toLocaleDateString('ko-KR');
            
            if (dailyRecords.length === 0) {
                recordsList.innerHTML = '<div class="empty-state">Ïò§Îäò Ï∂úÏûÖ Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            // ÏµúÏã† Í∏∞Î°ùÎ∂ÄÌÑ∞ ÌëúÏãú
            const sortedRecords = [...dailyRecords].sort((a, b) => b.endTime - a.endTime);
            
            recordsList.innerHTML = sortedRecords.map(record => {
                const durationClass = record.duration > 600 ? 'duration-danger' : 
                                    record.duration > 300 ? 'duration-warning' : 'duration-normal';
                
                const startTimeStr = new Date(record.startTime).toLocaleTimeString('ko-KR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const endTimeStr = new Date(record.endTime).toLocaleTimeString('ko-KR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const durationMin = Math.floor(record.duration / 60);
                const durationSec = record.duration % 60;
                const durationStr = `${durationMin}Î∂Ñ ${durationSec}Ï¥à`;
                
                return `
                    <div class="record-item">
                        <div class="record-info">
                            <div class="record-name">${record.name}</div>
                            <div class="record-number">Ï¢åÏÑù: ${record.number}Î≤à</div>
                        </div>
                        <div class="record-times">
                            <div class="record-duration ${durationClass}">${durationStr}</div>
                            <div class="record-time">${startTimeStr} ‚Üí ${endTimeStr}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function closeRecordsModal() {
            document.getElementById('recordsModal').style.display = 'none';
        }

        function exportRecords() {
            if (dailyRecords.length === 0) {
                showNotification('ÎÇ¥Î≥¥ÎÇº Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§.', 'warning');
                return;
            }
            
            const today = new Date().toLocaleDateString('ko-KR');
            let csvContent = `ÎèÖÏÑúÏã§ ÌôîÏû•Ïã§ Ï∂úÏûÖ Í∏∞Î°ù - ${today}\n\n`;
            csvContent += 'Ïù¥Î¶Ñ,Ï¢åÏÑùÎ≤àÌò∏,Ïô∏Ï∂úÏãúÍ∞Ñ,Î≥µÍ∑ÄÏãúÍ∞Ñ,Ïù¥Ïö©ÏãúÍ∞Ñ,Ï¥àÍ≥ºÏó¨Î∂Ä\n';
            
            dailyRecords.forEach(record => {
                const startTime = new Date(record.startTime).toLocaleTimeString('ko-KR');
                const endTime = new Date(record.endTime).toLocaleTimeString('ko-KR');
                const duration = `${Math.floor(record.duration / 60)}Î∂Ñ ${record.duration % 60}Ï¥à`;
                const overtime = record.isOvertime ? 'Ï¥àÍ≥º' : 'Ï†ïÏÉÅ';
                
                csvContent += `${record.name},${record.number},${startTime},${endTime},${duration},${overtime}\n`;
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `ÌôîÏû•Ïã§_Ï∂úÏûÖÍ∏∞Î°ù_${today.replace(/\./g, '')}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Ï∂úÏûÖ Í∏∞Î°ùÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.');
        }

        function clearDailyRecords() {
            if (confirm('Ïò§ÎäòÏùò Î™®Îì† Ï∂úÏûÖ Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                dailyRecords = [];
                todayCount = 0;
                saveDailyRecords();
                updateStats();
                closeRecordsModal();
                showNotification('Ï∂úÏûÖ Í∏∞Î°ùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
            }
        }

        // 1Î∂ÑÎßàÎã§ ÎÇ†Ïßú Î≥ÄÍ≤Ω Ï≤¥ÌÅ¨ Î∞è ÏÉÅÌÉú Ï†êÍ≤Ä
        setInterval(() => {
            checkDayReset();
            
            const overtimeUsers = activeUsers.filter(user => user.isOvertime);
            if (overtimeUsers.length > 0) {
                console.log(`ÌòÑÏû¨ ${overtimeUsers.length}Î™ÖÏù¥ ÏãúÍ∞Ñ Ï¥àÍ≥º ÏÉÅÌÉúÏûÖÎãàÎã§.`);
            }
        }, 60000); // 1Î∂ÑÎßàÎã§

        // ÌéòÏù¥ÏßÄ Ïñ∏Î°úÎìú Ïãú ÌôïÏù∏
        window.addEventListener('beforeunload', function(e) {
            if (activeUsers.length > 0) {
                e.returnValue = 'ÌòÑÏû¨ Ïô∏Ï∂ú Ï§ëÏù∏ ÌïôÏÉùÏù¥ ÏûàÏäµÎãàÎã§. ÌéòÏù¥ÏßÄÎ•º ÎÇòÍ∞ÄÏãúÍ≤†ÏäµÎãàÍπå?';
            }
        });
    </script>
</body>
</html>
